"use strict";function create(e){$.ajax({url:"api/carros",data:e,type:"POST",dataType:"JSON",success:function(e){"ok"==e.result?(getAll(),$("#modalCar").modal("hide")):document.getElementById("dvAlert").innerHTML="Houve um erro ao tentar cadastro seu carro."},error:function(e){}})}function update(e){$.ajax({url:"api/carros/"+e.id,data:e,type:"PUT",dataType:"JSON",success:function(e){"ok"==e.result?(getAll(),$("#modalCar").modal("hide")):document.getElementById("dvAlert").innerHTML="Houve um erro ao tentar cadastro seu carro."},error:function(e){console.log(e)}})}function editCar(e){$.ajax({url:"api/carros/"+e,data:{},type:"GET",dataType:"JSON",success:function(e){null!=typeof e&&null!=e&&(document.getElementById("txtMarca").value=e.Marca,document.getElementById("txtModelo").value=e.Modelo,document.getElementById("slAno").value=e.Ano,document.getElementById("txtId").value=e.Id,openModal(!1))},error:function(e){console.log(e)}})}function deleteCar(e){confirm("Deseja realmente remover?")&&$.ajax({url:"api/carros/"+e,data:{},type:"DELETE",dataType:"JSON",success:function(e){"ok"==e.result?getAll():document.getElementById("dvAlert").innerHTML="Houve um erro ao tentar remover o carro."},error:function(e){console.log(e)}})}function getAll(){$.ajax({url:"api/carros",data:{},type:"GET",dataType:"JSON",success:function(e){if(null!=typeof e&&null!=e){var t=document.getElementById("tbody");t.innerHTML="";for(var n=0;n<e.length;n++){var a="<tr><td>#"+e[n].Id+"</td><td>"+e[n].Marca+"</td><td>"+e[n].Modelo+"</td><td>"+e[n].Ano+"</td><td><a href='#' class='btn btn-outline-warning m-2' onclick='editCar("+e[n].Id+");'><img src='img/icon/edit.png' alt='Edit' class='link-icon'></a><a href='#' class='btn btn-outline-danger  m-2' onclick='deleteCar("+e[n].Id+");'><img src='img/icon/delete.png' alt='Delete' class='link-icon'></a></td></tr>";t.innerHTML+=a}}},error:function(e){console.log(e)}})}function openModal(e=!0){e&&resetForm(),$("#modalCar").modal("show")}function validate(e){var t="";(e.marca.length<=2||e.marca.length>100)&&(t+="<p>- O campo <span class='font-weight-bold text-primary'>marca</span> deve conter entre 3 a 100 caracteres.</p>"),(e.modelo.length<=2||e.modelo.length>100)&&(t+="<p>- O campo <span class='font-weight-bold text-primary'>modelo</span> deve conter entre 3 a 100 caracteres.</p>");var n=(new Date).getFullYear()+1;return(e.ano<=1980||e.ano>n)&&(t+="<p>- O <span class='font-weight-bold text-primary'>ano</span> deve estar entre 1980 e "+n+".</p>"),e.id<0&&(t+="<p>- ID inv√°lido.</p>"),""!=t&&(document.getElementById("dvAlert").innerHTML=t),""==t}function fillYear(){for(var e=document.getElementById("slAno"),t=(new Date).getFullYear(),n=1980;n<=t+1;n++){var a=document.createElement("option");a.value=n,a.innerText=n,e.appendChild(a)}e.value=t}function resetForm(){document.getElementById("txtMarca").value="",document.getElementById("txtModelo").value="",document.getElementById("slAno").value=(new Date).getFullYear(),document.getElementById("txtId").value="0",document.getElementById("dvAlert").innerHTML="<p>- Preencha todos os campos.</p>"}fillYear(),resetForm(),getAll(),document.getElementById("frmCarro").addEventListener("submit",function(e){var t={marca:document.getElementById("txtMarca").value,modelo:document.getElementById("txtModelo").value,ano:document.getElementById("slAno").value,id:document.getElementById("txtId").value};validate(t)&&(0==t.id?create(t):update(t)),e.preventDefault()});
